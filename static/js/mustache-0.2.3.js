var Mustache=function(){var a=function(){};a.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},render:function(e,d,c,f){if(e.indexOf(this.otag)==-1){if(f){return e}else{this.send(e);return}}if(!f){this.buffer=[]}e=this.render_pragmas(e);var b=this.render_section(e,d,c);if(f){return this.render_tags(b,d,c,f)}this.render_tags(b,d,c,f)},send:function(b){if(b!=""){this.buffer.push(b)}},render_pragmas:function(b){if(b.indexOf(this.otag+"%")==-1){return b}var d=this;var c=new RegExp(this.otag+"%([\\w_-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return b.replace(c,function(g,e,f){if(!d.pragmas_implemented[e]){throw ({message:"This implementation of mustache doesn't understand the '"+e+"' pragma"})}d.pragmas[e]={};if(f){var h=f.split("=");d.pragmas[e][h[0]]=h[1]}return""})},render_partial:function(b,d,c){if(!c||!c[b]){throw ({message:"unknown_partial '"+b+"'"})}if(typeof(d[b])!="object"){return c[b]}return this.render(c[b],d[b],c,true)},render_section:function(d,c,b){if(d.indexOf(this.otag+"#")==-1){return d}var f=this;var e=new RegExp(this.otag+"\\#(.+)"+this.ctag+"\\s*([\\s\\S]+?)"+this.otag+"\\/\\1"+this.ctag+"\\s*","mg");return d.replace(e,function(h,g,i){var j=f.find(g,c);if(f.is_array(j)){return f.map(j,function(k){return f.render(i,f.merge(c,f.create_context(k)),b,true)}).join("")}else{if(j){return f.render(i,c,b,true)}else{return""}}})},render_tags:function(j,b,d,f){var e=this;var h=function(){return new RegExp(e.otag+"(=|!|>|\\{|%)?([^/#]+?)\\1?"+e.ctag+"+","g")};var g=h();var k=j.split("\n");for(var c=0;c<k.length;c++){k[c]=k[c].replace(g,function(m,i,l){switch(i){case"!":return m;case"=":e.set_delimiters(l);g=h();return"";case">":return e.render_partial(l,b,d);case"{":return e.find(l,b);default:return e.escape(e.find(l,b))}},this);if(!f){this.send(k[c])}}if(f){return k.join("\n")}},set_delimiters:function(c){var b=c.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(c){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return c.replace(arguments.callee.sRE,"\\$1")},find:function(b,c){b=this.trim(b);if(typeof c[b]==="function"){return c[b].apply(c)}if(c[b]!==undefined){return c[b]}return""},escape:function(b){return((b==null)?"":b).toString().replace(/[&"<>\\]/g,function(c){switch(c){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return c}})},merge:function(d,c){var f={};for(var e in d){if(d.hasOwnProperty(e)){f[e]=d[e]}}for(var e in c){if(c.hasOwnProperty(e)){f[e]=c[e]}}return f},create_context:function(c){if(this.is_object(c)){return c}else{if(this.pragmas["IMPLICIT-ITERATOR"]){var d=this.pragmas["IMPLICIT-ITERATOR"].iterator||".";var b={};b[d]=c;return b}}},is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(f,d){if(typeof f.map=="function"){return f.map(d)}else{var e=[];var b=f.length;for(var c=0;c<b;c++){e.push(d(f[c]))}return e}}};return({name:"mustache.js",version:"0.2.3",to_html:function(d,b,c,f){var e=new a();if(f){e.send=f}e.render(d,b,c);if(!f){return e.buffer.join("\n")}}})}();